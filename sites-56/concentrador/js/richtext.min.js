var isRichText=false;var rng;var currentRTE;var allRTEs="";var isIE;var isGecko;var isSafari;var isKonqueror;var imagesPath;var includesPath;var cssFile;var generateXHTML;var lang="en";var encoding="iso-8859-1";function initRTE(imgPath,incPath,css,genXHTML){var ua=navigator.userAgent.toLowerCase();isIE=((ua.indexOf("msie")!=-1)&&(ua.indexOf("opera")==-1)&&(ua.indexOf("webtv")==-1));isGecko=(ua.indexOf("gecko")!=-1);isSafari=(ua.indexOf("safari")!=-1);isKonqueror=(ua.indexOf("konqueror")!=-1);generateXHTML=genXHTML;if(document.getElementById&&document.designMode&&!isSafari&&!isKonqueror){isRichText=true;}
if(isIE){document.onmouseover=raiseButton;document.onmouseout=normalButton;document.onmousedown=lowerButton;document.onmouseup=raiseButton;}
imagesPath=imgPath;includesPath=incPath;cssFile=css;if(isRichText)document.writeln('<style type="text/css">@import "'+includesPath+'rte.css";</style>');}
function writeRichText(rte,html,width,height,buttons,readOnly){if(isRichText){if(allRTEs.length>0)allRTEs+=";";allRTEs+=rte;if(readOnly)buttons=false;if(isIE){if(buttons&&(width<400))width=400;var tablewidth=width;}else{if(buttons&&(width<400))width=400;var tablewidth=width+4;}
document.writeln('<div class="rteDiv">');if(buttons==true){document.writeln('<table class="rteBack" cellpadding=2 cellspacing=0 id="Buttons1_'+rte+'" width="'+tablewidth+'">');document.writeln('	<tr>');document.writeln('		<td>');document.writeln('			<select class="formul" id="formatblock_'+rte+'" onchange="selectFont(\''+rte+'\', this.id);">');document.writeln('				<option value="">[Style]</option>');document.writeln('				<option value="<p>">Paragraph &lt;p&gt;</option>');document.writeln('				<option value="<h1>">Heading 1 &lt;h1&gt;</option>');document.writeln('				<option value="<h2>">Heading 2 &lt;h2&gt;</option>');document.writeln('				<option value="<h3>">Heading 3 &lt;h3&gt;</option>');document.writeln('				<option value="<h4>">Heading 4 &lt;h4&gt;</option>');document.writeln('				<option value="<h5>">Heading 5 &lt;h5&gt;</option>');document.writeln('				<option value="<h6>">Heading 6 &lt;h6&gt;</option>');document.writeln('				<option value="<address>">Address &lt;ADDR&gt;</option>');document.writeln('				<option value="<pre>">Formatted &lt;pre&gt;</option>');document.writeln('			</select>');document.writeln('		</td>');document.writeln('		<td>');document.writeln('			<select class="formul" id="fontname_'+rte+'" onchange="selectFont(\''+rte+'\', this.id)">');document.writeln('				<option value="Font" selected>[Font]</option>');document.writeln('				<option class="arial" value="Arial, Helvetica, sans-serif">Arial</option>');document.writeln('				<option class="curier" value="Courier New, Courier, mono">Courier New</option>');document.writeln('				<option class="times" value="Times New Roman, Times, serif">Times New Roman</option>');document.writeln('				<option value="Verdana, Arial, Helvetica, sans-serif">Verdana</option>');document.writeln('			</select>');document.writeln('		</td>');document.writeln('		<td>');document.writeln('			<select class="formul" unselectable="on" id="fontsize_'+rte+'" onchange="selectFont(\''+rte+'\', this.id);">');document.writeln('				<option value="Size">[Size]</option>');document.writeln('				<option value="1">1</option>');document.writeln('				<option value="2">2</option>');document.writeln('				<option value="3">3</option>');document.writeln('				<option value="4">4</option>');document.writeln('				<option value="5">5</option>');document.writeln('				<option value="6">6</option>');document.writeln('				<option value="7">7</option>');document.writeln('			</select>');document.writeln('		</td>');document.writeln('		<td width="100%">');document.writeln('		</td>');document.writeln('	</tr>');document.writeln('</table>');document.writeln('<table class="rteBack" cellpadding="0" cellspacing="0" id="Buttons2_'+rte+'" width="'+tablewidth+'">');document.writeln('	<tr>');document.writeln('		<td><img id="bold" class="rteImage" src="'+imagesPath+'bold.gif" width="25" height="24" alt="Bold" title="'+Alt_bold+' " onClick="rteCommand(\''+rte+'\', \'bold\', \'\')"></td>');document.writeln('		<td><img class="rteImage" src="'+imagesPath+'italic.gif" width="25" height="24" alt="Italic" title="'+Alt_italic+'" onClick="rteCommand(\''+rte+'\', \'italic\', \'\')"></td>');document.writeln('		<td><img class="rteImage" src="'+imagesPath+'underline.gif" width="25" height="24" alt="Underline" title="'+Alt_underlined+'" onClick="rteCommand(\''+rte+'\', \'underline\', \'\')"></td>');document.writeln('		<td><img class="rteVertSep" src="'+imagesPath+'blackdot.gif" width="1" height="20" border="0" alt=""></td>');document.writeln('		<td><img class="rteImage" src="'+imagesPath+'left_just.gif" width="25" height="24" alt="Align Left" title="'+Alt_left+'" onClick="rteCommand(\''+rte+'\', \'justifyleft\', \'\')"></td>');document.writeln('		<td><img class="rteImage" src="'+imagesPath+'centre.gif" width="25" height="24" alt="Center" title="'+Alt_center+'" onClick="rteCommand(\''+rte+'\', \'justifycenter\', \'\')"></td>');document.writeln('		<td><img class="rteImage" src="'+imagesPath+'right_just.gif" width="25" height="24" alt="Align Right" title="'+Alt_right+'" onClick="rteCommand(\''+rte+'\', \'justifyright\', \'\')"></td>');document.writeln('		<td><img class="rteImage" src="'+imagesPath+'justifyfull.gif" width="25" height="24" alt="Justify Full" title="'+Alt_justify+'" onclick="rteCommand(\''+rte+'\', \'justifyfull\', \'\')"></td>');document.writeln('		<td><img class="rteVertSep" src="'+imagesPath+'blackdot.gif" width="1" height="20" border="0" alt=""></td>');document.writeln('		<td><img class="rteImage" src="'+imagesPath+'hr.gif" width="25" height="24" alt="Horizontal Rule" title="'+Alt_linea+'" onClick="rteCommand(\''+rte+'\', \'inserthorizontalrule\', \'\')"></td>');document.writeln('		<td><img class="rteVertSep" src="'+imagesPath+'blackdot.gif" width="1" height="20" border="0" alt=""></td>');document.writeln('		<td><img class="rteImage" src="'+imagesPath+'numbered_list.gif" width="25" height="24" alt="Ordered List" title="'+Alt_ordenada+'" onClick="rteCommand(\''+rte+'\', \'insertorderedlist\', \'\')"></td>');document.writeln('		<td><img class="rteImage" src="'+imagesPath+'list.gif" width="25" height="24" alt="Unordered List" title="'+Alt_nordenada+'" onClick="rteCommand(\''+rte+'\', \'insertunorderedlist\', \'\')"></td>');document.writeln('		<td><img class="rteVertSep" src="'+imagesPath+'blackdot.gif" width="1" height="20" border="0" alt=""></td>');document.writeln('		<td><img class="rteImage" src="'+imagesPath+'outdent.gif" width="25" height="24" alt="Outdent" title="'+Alt_indent+'" onClick="rteCommand(\''+rte+'\', \'outdent\', \'\')"></td>');document.writeln('		<td><img class="rteImage" src="'+imagesPath+'indent.gif" width="25" height="24" alt="Indent" title="'+Alt_outdent+'" onClick="rteCommand(\''+rte+'\', \'indent\', \'\')"></td>');document.writeln('		<td><div id="forecolor_'+rte+'"><img class="rteImage" src="'+imagesPath+'textcolor.gif" width="25" height="24" alt="Text Color" title="'+Alt_tColor+'" onClick="dlgColorPalette(\''+rte+'\', \'forecolor\', \'\')"></div></td>');document.writeln('		<td><div id="hilitecolor_'+rte+'"><img class="rteImage" src="'+imagesPath+'bgcolor.gif" width="25" height="24" alt="Background Color" title="'+Alt_bColor+'" onClick="dlgColorPalette(\''+rte+'\', \'hilitecolor\', \'\')"></div></td>');document.writeln('		<td><img class="rteVertSep" src="'+imagesPath+'blackdot.gif" width="1" height="20" border="0" alt=""></td>');document.writeln('		<td><img class="rteImage" src="'+imagesPath+'hyperlink.gif" width="25" height="24" alt="Insert Link" title="'+Alt_link+'" onClick="dlgInsertLink(\''+rte+'\', \'link\')"></td>');document.writeln('		<td><div id="imagen_'+rte+'"><img class="rteImage" src="'+imagesPath+'image.gif" width="25" height="24" alt="Add Image" title="'+Alt_imagen+'" onClick="addImage(\''+rte+'\', cam_imagen)"></div></td>');document.writeln('		<td><div id="table_'+rte+'"><img class="rteImage" src="'+imagesPath+'insert_table.gif" width="25" height="24" alt="Insert Table" title="'+Alt_tabla+'" onClick="dlgInsertTable(\''+rte+'\', \'table\', \'\')"></div></td>');if(isIE){}
document.writeln('		<td width="100%"></td>');document.writeln('	</tr>');document.writeln('</table>');}
document.writeln('<iframe id="'+rte+'" name="'+rte+'" width="'+width+'px" height="'+height+'px" src="'+includesPath+'blank.htm"></iframe>');if(!readOnly)document.writeln('<br /><input type="checkbox" id="chkSrc'+rte+'" onclick="toggleHTMLSrc(\''+rte+'\','+buttons+');" />&nbsp;<label for="chkSrc'+rte+'">'+Alt_source+'</label>');document.writeln('<iframe width="154" height="104" id="cp'+rte+'" src="'+includesPath+'palette.htm" marginwidth="0" marginheight="0" scrolling="no" style="visibility:hidden; position: absolute;"></iframe>');document.writeln('<input type="hidden" id="hdn'+rte+'" name="'+rte+'" value="">');document.writeln('</div>');document.getElementById('hdn'+rte).value=html;enableDesignMode(rte,html,readOnly);}else{if(!readOnly){document.writeln('<textarea class="formul" name="'+rte+'" id="'+rte+'" style="width: '+width+'px; height: '+height+'px;">'+html+'</textarea>');}else{document.writeln('<textarea class="formul" name="'+rte+'" id="'+rte+'" style="width: '+width+'px; height: '+height+'px;" readonly>'+html+'</textarea>');}}}
function enableDesignMode(rte,html,readOnly){var frameHtml="<html id=\""+rte+"\">\n";frameHtml+="<head>\n";if(cssFile.length>0){frameHtml+="<link media=\"all\" type=\"text/css\" href=\""+cssFile+"\" rel=\"stylesheet\">\n";}else{frameHtml+="<style>\n";frameHtml+="body {\n";frameHtml+="	background: #FFFFFF;\n";frameHtml+="	margin: 0px;\n";frameHtml+="	padding: 0px;\n"
frameHtml+="	font-family:Verdana, Arial, Helvetica, sans-serif;\n"
frameHtml+="	font-size:10px\n";frameHtml+="}\n";frameHtml+="</style>\n";}
frameHtml+="</head>\n";frameHtml+="<body>\n";frameHtml+=html+"\n";frameHtml+="</body>\n";frameHtml+="</html>";if(document.all){var oRTE=frames[rte].document;oRTE.open();oRTE.write(frameHtml);oRTE.close();if(!readOnly){oRTE.designMode="On";frames[rte].document.attachEvent("onkeypress",function evt_ie_keypress(event){ieKeyPress(event,rte);});}}else{try{if(!readOnly)document.getElementById(rte).contentDocument.designMode="on";try{var oRTE=document.getElementById(rte).contentWindow.document;oRTE.open();oRTE.write(frameHtml);oRTE.close();if(isGecko&&!readOnly){oRTE.addEventListener("keypress",geckoKeyPress,true);}}catch(e){alert("Error preloading content.");}}catch(e){if(isGecko){setTimeout("enableDesignMode('"+rte+"', '"+html+"', "+readOnly+");",10);}else{return false;}}}}
function updateRTE(rte){if(!isRichText)return;var readOnly=false;if(document.all){if(frames[rte].document.designMode!="On")readOnly=true;}else{if(document.getElementById(rte).contentDocument.designMode!="on")readOnly=true;}
if(isRichText&&!readOnly){if(document.getElementById("chkSrc"+rte).checked)document.getElementById("chkSrc"+rte).click();setHiddenVal(rte);}}
function setHiddenVal(rte){var oHdnField=document.getElementById('hdn'+rte);if(oHdnField.value==null)oHdnField.value="";if(document.all){if(generateXHTML){oHdnField.value=get_xhtml(frames[rte].document.body,lang,encoding);}else{oHdnField.value=frames[rte].document.body.innerHTML;}}else{if(generateXHTML){oHdnField.value=get_xhtml(document.getElementById(rte).contentWindow.document.body,lang,encoding);}else{oHdnField.value=document.getElementById(rte).contentWindow.document.body.innerHTML;}}
if(stripHTML(oHdnField.value.replace("&nbsp;"," "))==""&&oHdnField.value.toLowerCase().search("<hr")==-1&&oHdnField.value.toLowerCase().search("<img")==-1)oHdnField.value="";}
function updateRTEs(){var vRTEs=allRTEs.split(";");for(var i=0;i<vRTEs.length;i++){updateRTE(vRTEs[i]);}}
function rteCommand(rte,command,option){var oRTE;if(document.all){oRTE=frames[rte];}else{oRTE=document.getElementById(rte).contentWindow;}
try{oRTE.focus();oRTE.document.execCommand(command,false,option);oRTE.focus();}catch(e){}}
function toggleHTMLSrc(rte,buttons){var oHdnField=document.getElementById('hdn'+rte);if(document.getElementById("chkSrc"+rte).checked){if(buttons){showHideElement("Buttons1_"+rte,"hide");showHideElement("Buttons2_"+rte,"hide");}
setHiddenVal(rte);if(document.all){frames[rte].document.body.innerText=oHdnField.value;}else{var oRTE=document.getElementById(rte).contentWindow.document;var htmlSrc=oRTE.createTextNode(oHdnField.value);oRTE.body.innerHTML="";oRTE.body.appendChild(htmlSrc);}}else{if(buttons){showHideElement("Buttons1_"+rte,"show");showHideElement("Buttons2_"+rte,"show");}
if(document.all){var output=escape(frames[rte].document.body.innerText);output=output.replace("%3CP%3E%0D%0A%3CHR%3E","%3CHR%3E");output=output.replace("%3CHR%3E%0D%0A%3C/P%3E","%3CHR%3E");frames[rte].document.body.innerHTML=unescape(output);}else{var oRTE=document.getElementById(rte).contentWindow.document;var htmlSrc=oRTE.body.ownerDocument.createRange();htmlSrc.selectNodeContents(oRTE.body);oRTE.body.innerHTML=htmlSrc.toString();}}}
function dlgColorPalette(rte,command){setRange(rte);var oDialog=document.getElementById('cp'+rte);var buttonElement=document.getElementById(command+'_'+rte);var iTopPos=getOffsetTop(buttonElement)+(buttonElement.offsetHeight+4);var iLeftPos=getOffsetLeft(buttonElement);oDialog.style.left=(iLeftPos)+"px";oDialog.style.top=(iTopPos)+"px";if((command==parent.command)&&(rte==currentRTE)){if(oDialog.style.visibility=="hidden"){showHideElement(oDialog,'show');}else{showHideElement(oDialog,'hide');}}else{var vRTEs=allRTEs.split(";");for(var i=0;i<vRTEs.length;i++){showHideElement('cp'+vRTEs[i],'hide');}
showHideElement(oDialog,'show');}
parent.command=command;currentRTE=rte;}
function dlgInsertTable(rte,command){parent.command=command;currentRTE=rte;InsertTable=popUpWin(includesPath+'insert_table.htm','InsertTable',320,180,'');}
function dlgInsertLink(rte,command){parent.command=command;currentRTE=rte;InsertLink=popUpWin(includesPath+'insert_link.htm','InsertLink',360,180,'');setRange(rte);var linkText='';if(isIE){linkText=stripHTML(rng.htmlText);}else{linkText=stripHTML(rng.toString());}
setLinkText(linkText);}
function setLinkText(linkText){try{window.InsertLink.document.linkForm.linkText.value=linkText;}catch(e){setTimeout("setLinkText('"+linkText+"');",10);}}
function popUpWin(url,win,width,height,options){var leftPos=(screen.availWidth-width)/2;var topPos=(screen.availHeight-height)/2;options+='width='+width+',height='+height+',left='+leftPos+',top='+topPos;return window.open(url,win,options);}
function setColor(color){var rte=currentRTE;var parentCommand=parent.command;if(document.all){if(parentCommand=="hilitecolor")parentCommand="backcolor";rng.select();}
rteCommand(rte,parentCommand,color);showHideElement('cp'+rte,"hide");}
function addImage(rte,direccion){imagePath=prompt('Enter Image URL:',direccion);if((imagePath!=null)&&(imagePath!="")){rteCommand(rte,'InsertImage',imagePath);}}
function getOffsetTop(elm){var mOffsetTop=elm.offsetTop;var mOffsetParent=elm.offsetParent;while(mOffsetParent.nodeName!='BODY'){mOffsetTop+=mOffsetParent.offsetTop;mOffsetParent=mOffsetParent.offsetParent;}
return mOffsetTop;}
function getOffsetLeft(elm){var mOffsetLeft=elm.offsetLeft;var mOffsetParent=elm.offsetParent;while(mOffsetParent.nodeName!='BODY'){mOffsetLeft+=mOffsetParent.offsetLeft;mOffsetParent=mOffsetParent.offsetParent;}
return mOffsetLeft;}
function selectFont(rte,selectname){var idx=document.getElementById(selectname).selectedIndex;if(idx!=0){var selected=document.getElementById(selectname).options[idx].value;var cmd=selectname.replace('_'+rte,'');rteCommand(rte,cmd,selected);document.getElementById(selectname).selectedIndex=0;}}
function insertHTML(html){var rte=currentRTE;var oRTE;if(document.all){oRTE=frames[rte];}else{oRTE=document.getElementById(rte).contentWindow;}
oRTE.focus();if(document.all){var oRng=oRTE.document.selection.createRange();oRng.pasteHTML(html);oRng.collapse(false);oRng.select();}else{oRTE.document.execCommand('insertHTML',false,html);}}
function showHideElement(element,showHide){if(document.getElementById(element)){element=document.getElementById(element);}
if(showHide=="show"){element.style.visibility="visible";}else if(showHide=="hide"){element.style.visibility="hidden";}}
function setRange(rte){var oRTE;if(document.all){oRTE=frames[rte];var selection=oRTE.document.selection;if(selection!=null)rng=selection.createRange();}else{oRTE=document.getElementById(rte).contentWindow;var selection=oRTE.getSelection();rng=selection.getRangeAt(selection.rangeCount-1).cloneRange();}
return rng;}
function stripHTML(oldString){var newString=oldString.replace(/(<([^>]+)>)/ig,"");newString=newString.replace(/\r\n/g," ");newString=newString.replace(/\n/g," ");newString=newString.replace(/\r/g," ");newString=trim(newString);return newString;}
function trim(inputString){if(typeof inputString!="string")return inputString;var retValue=inputString;var ch=retValue.substring(0,1);while(ch==" "){retValue=retValue.substring(1,retValue.length);ch=retValue.substring(0,1);}
ch=retValue.substring(retValue.length-1,retValue.length);while(ch==" "){retValue=retValue.substring(0,retValue.length-1);ch=retValue.substring(retValue.length-1,retValue.length);}
while(retValue.indexOf("  ")!=-1){retValue=retValue.substring(0,retValue.indexOf("  "))+retValue.substring(retValue.indexOf("  ")+1,retValue.length);}
return retValue;}
function geckoKeyPress(evt){var rte=evt.target.id;if(evt.ctrlKey){var key=String.fromCharCode(evt.charCode).toLowerCase();var cmd='';switch(key){case'b':cmd="bold";break;case'i':cmd="italic";break;case'u':cmd="underline";break;};if(cmd){rteCommand(rte,cmd,null);evt.preventDefault();evt.stopPropagation();}}}
function ieKeyPress(evt,rte){var key=(evt.which||evt.charCode||evt.keyCode);var stringKey=String.fromCharCode(key).toLowerCase();}
function checkspell(){try{var tmpis=new ActiveXObject("ieSpell.ieSpellExtension");tmpis.CheckAllLinkedDocuments(document);}
catch(exception){if(exception.number==-2146827859){if(confirm("ieSpell not detected.  Click Ok to go to download page."))
window.open("http://www.iespell.com/download.php","DownLoad");}else{alert("Error Loading ieSpell: Exception "+exception.number);}}}
function raiseButton(e){var el=window.event.srcElement;className=el.className;if(className=='rteImage'||className=='rteImageLowered'){el.className='rteImageRaised';}}
function normalButton(e){var el=window.event.srcElement;className=el.className;if(className=='rteImageRaised'||className=='rteImageLowered'){el.className='rteImage';}}
function lowerButton(e){var el=window.event.srcElement;className=el.className;if(className=='rteImage'||className=='rteImageRaised'){el.className='rteImageLowered';}}